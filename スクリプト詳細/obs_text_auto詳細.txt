
■ 1. 基本設定・OBS接続情報管理

・監視ルートフォルダを指定

・OBS WebSocket のホスト・ポート・トークンを読み込み

・監視対象キャラ名（4種）を定義


■ 2. OBSテキスト更新処理（update_obs_text）

・WebSocketClient で OBS に接続

・SetInputSettings によりテキストを一度空にしてから新規テキストを設定

・更新完了後は接続を切断


■ 3. 最新テキスト取得処理（latest_text）

・フォルダ内のファイル.txtを更新日時でソート

・最新ファイルの内容を UTF-8 で読み取り返却

・ファイルが無い場合は None を返す


■ 4. 監視イベント処理（DirHandler）

・ファイル更新イベントを監視し txt の更新を検出

・他キャラのテキストを全て空にする

・自キャラのみ最新内容を OBS に送信

・更新時刻の差分で重複反応を防止


■ 5. 起動時初期化処理

・全キャラフォルダ内の txt ファイルを削除

・OBS の全テキストソースを空にリセット

・各キャラの最新テキストがあれば反映


■ 6. ファイル監視の開始

・watchdog を用いて各キャラフォルダを監視

・DirHandler を割り当てイベントを受け取る

・Observer を起動して監視を開始


■ 7. “end” コマンド受付スレッド

・別スレッドで input() を監視し “end” を検出

・入力されたら os._exit(0) により即時終了


■ 8. メインループ管理

・observer を複数起動し join で待機

・例外発生時も finally で停止処理を実行

・監視を維持したまま常時稼働


■ 9. 終了処理

・全 Observer を停止

・join により終了を待機

・プロセス終了時に監視を完全停止