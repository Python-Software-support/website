
■ 1. 出力先設定

・sys.stdout を指定ファイル.txt に書き換えて全出力を保存

・UTF-8 でテキストとして書き込む


■ 2. 日時情報の記録

・現在日時を取得して「出力日時」としてファイル先頭に追加

・レポート生成時刻の記録に使用


■ 3. Python バージョン情報取得

・sys.version により Python バージョン文字列を出力

・sys.executable で現在使用中の Python 実行ファイルパスを出力


■ 4. インストール済みパッケージ一覧取得

・subprocess.run(["pip", "list"]) を実行してパッケージ一覧を取得

・取得結果をそのままファイルに書き込み

・取得失敗時はエラーメッセージを出力


■ 5. 出力完了処理

・末尾に「--- 出力完了 ---」を記載

・sys.stdout.close() により書き込みを終了