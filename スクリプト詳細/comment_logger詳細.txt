
■ 1. 基本設定

・YouTube APIキーを環境変数から取得

・監視対象チャンネルIDを指定

・コメント保存先 JSON ファイルのパスを設定

・ポーリング間隔（POLL_INTERVAL）を設定


■ 2. ライブ配信ID取得処理（get_live_chat_id）

・search API を使い「現在ライブ中の配信」を検出

・配信が見つからない場合は None を返す

・videoId を元に videos API から liveStreamingDetails を取得

・activeLiveChatId を抽出し、ライブチャット監視の開始点を返す


■ 3. ライブコメント取得処理（get_live_chat_messages）

・liveChat.messages API を使用しコメント一覧を取得

・pageToken による続き取得に対応

・snippet と authorDetails を含めて返却


■ 4. コメント監視ループの開始（main）

・ライブ配信 ID を取得し、取得できない場合は終了

・next_page_token と seen_message_ids を初期化

・while True で常時コメントポーリングを実施


■ 5. コメントのフィルタリング処理

・取得したコメントの ID を set で管理し重複を排除

・#AI / #ai / #ＡＩ を含むコメントのみ抽出

・抽出コメントをコンソールへ表示


■ 6. コメント保存処理

・保存先フォルダが無い場合は自動作成

・既存 JSON を読み込み不正なら空リストで初期化

・日時 / 名前 / コメント を JSON 配列へ追加

・整形（indent=2）して JSON を上書き保存


■ 7. 手動終了処理

・毎ループで「end」入力を受け付ける

・入力が end の場合はループを抜けて終了


■ 8. エラーハンドリング

・APIエラー・ネットワークエラーなどの例外を捕捉

・発生時にはメッセージ表示後 10 秒待機して再試行
